BootStrap: docker
From: nvidia/cuda:10.1-devel-ubuntu18.04

%environment
    export LC_ALL=C
    export nvcc_arch="sm_37"

%post
    apt update
    apt install -y git
    apt install -y openjdk-11-jdk
    apt install -y maven
    apt install -y gcc

    cd /usr/local/src
    git clone https://github.com/shermanlo77/modefilter.git
    cd modefilter
    sed -i -r 's/sm_[0-9]+/'${nvcc_arch}'/g' Makefile
    make
    mvn package

%runscript
    unset DISPLAY
    java -jar /usr/local/src/modefilter/target/Empirical_Null_Filter-*.jar "$@"
